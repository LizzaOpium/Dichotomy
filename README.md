
## Дихотомия
Alexeyy, December 25, 2025
Введение:

Недавно показали дихотомию, я захотел поделиться. Если вкратце, то я попробовал реализовать сам способ и прикрутить туда визуализацию со вводом функции пользователем, графический калькулятор, который был представлен в моем канале ранее, получился неидеальным, поэтому наработки оттуда пошли в новый код. 
Дихотомию я применил для нахождения максимума функции, можно провернуть все то же самое и для минимума, если поменять пару строчек кода.


Как работает сам принцип в моей программе:

Программа рассматривает отрезок от некого числа a до b на оси Ox, находит его центр - c, и сравнивает значения функций в точках c + r, c - r, где r - некоторое отклонение от центра, затем, мы можем получить два исхода:


1) f(c+r) > f(c-r) - в таком случае программа переносит левую границу отрезка (a) в точку c, и рассматривает уже другой отрезок, на котором, как уже определено по неравенству, находится максимум нужной функции: (c, b)

2) f(c+r) < f(c-r) - здесь программа делает все в точности да наоборот, т.е. b -> c, рассматривается отрезок: (a, c)

Графическое изображение описываемых точек:


Прочие улучшения и ручной ввод функции:

Улучшения:

1) Реализовано графическое отображение графика рассматриваемой функции на оси координат в промежутке, на котором мы ищем максимум функции через Pyplot:

(в начале программы прописано: from matplotlib import pyplot as plt => plt <=> pyplot)

==============================================

x = np.linspace(a, b, 1000)
y = f(x)

plt.axhline(y=f(c), color='blue', linestyle='--')
plt.axvline(x=c, color='blue', linestyle='--')
plt.plot(x, y, label='f(x)', color = 'red', linestyle = 'solid')
plt.title('График f(x)')
plt.xlabel('x')
plt.ylabel('y')
plt.grid(True)
plt.show()

Замечание: y = f(c) и x = c - прямые, пересечение которых отображает точку максимума, найденную способом дихотомии;

2) Реализован ручной ввод функции пользователем:

    Словарь, использующий функции библиотеки Numpy был написан для  большего удобства пользователя при вводе функции:

dict = {
    'x': x,
    'sin': np.sin,
    'cos': np.cos,
    'tan': np.tan,
    'exp': np.exp,
    'log': np.log,
    'sqrt': np.sqrt,
    'abs': np.abs,
    'pi': np.pi,
    'e': np.e,
    'X': x
}

    Ввод функции реализован через функцию eval:

eval(func, dict)

3) Пользователь сам может выбрать, в каких промежутках мы будем рассматривать максимум функции:

func = input('> Введите функцию f(x) = ')
a = float(input('   Введите начало отрезка: '))
b = float(input('   Введите конец отрезка: '))

4) Функция строится на оси только в пределах промежутка, выбранного пользователем:

    Вывод программы:

    > Введите функцию f(x) = -x**2 + 123

      Введите начало отрезка: -1

      Введите конец отрезка: 1

    > Найден максимум функции: 

    f(x_max) = 123.0, x_max = 0.0

    Окно Matplotlib:

f(x) = -x^2 + 123
Минусы и плюсы программы:

1) Плюсы:

    Можно без изменения в коде менять функцию и промежутки, на которых осуществляется поиск значения аргумента, при котором функция будет иметь свое наибольшее значение;
    Наглядно видно, что погрешность в полученных ответах минимальна за счет небольшого шага: 10^-6:

Окно Matplotlib:
f(x) = -x^2 + 123

погрешность в пределах нормы, изображение для f(x) = -x^2 + 123

Вывод программы: 

    > Найден максимум функции: 

    f(x_max) = 123.0, x_max = 0.0

Действительный максимум:

    (0; 123)

Сходство в ответах достигнуто за счет округления ответа до 4 цифр после запятой;

2) Минусы:

    Ограниченный мат. аппарат, доступны лишь те функции, которые введены в словарь, показанный ранее;
    Программа найдет только первый, встреченный ею максимум функции, остальные искать не будет, завершив работу:

Вывод программы:

    > Введите функцию f(x) = sin(x)

      Введите начало отрезка: 9

      Введите конец отрезка: 24

    > Найден максимум функции: 

    f(x_max) = 1.0, x_max = 14.1372

Окно Matplotlib:
f(x) = sin(x)

    Возможно программа будет долго работать при сложных функциях за счет не самого оптимального принципа нахождения максимума (для оптимизации можно попробовать использовать метод золотого сечения или уменьшить шаг);
    Возможно не все функции будут работать: есть большая вероятность, что какой-нибудь умелый физмат придумает хитрую функцию и сломает программу, что в целом не удивительно;


Вывод:

В данный момент эта программа удовлетворяет большинство потребностей: находит максимум функции, изображает ее на оси, графически отражая погрешность с большой точностью, я не запрещаю использовать свои наработки в своих проектах или для собственного интереса, тем более, данный способ был кучу раз описан и программ и с его использованием туча. Все минусы будут подвергнуты доработкам в будущем;


Код проекта:

import numpy as np
from matplotlib import pyplot as plt

'''
Словарь для большего удобства
'''

def f(x):
    dict = {
        'x': x,
        'sin': np.sin,
        'cos': np.cos,
        'tan': np.tan,
        'exp': np.exp,
        'log': np.log,
        'sqrt': np.sqrt,
        'abs': np.abs,
        'pi': np.pi,
        'e': np.e,
        'X': x
    }
    return eval(func, dict)

'''
Дихтомия, принимает на вход функцию и a, b
a, b - границы отрезка
'''

def dichotomy(a, b):
    eps = 1e-6 # эпсилон - он же шаг
    r = eps/2 # отступы от середины отрезка
    global c # ввел глобальную переменную, чтобы потом ее использовать

    while abs(b - a) > eps: # оценка отрезков, пока их длина не станет меньше шага
        c = (a + b) / 2

        # сравним значения функций по разные концы отрезка:

        if f(c - r) > f(c + r):
            b = c
        else:
            a = c
    # вывод данных
    print('> Найден максимум функции: ')
    # округление сделано до 4 цифр после запятой для большего удобства
    return f'f(x_max) = {round(f(c), 4)}, x_max = {round(c, 4)}'

'''
Основная функция для работы программы,
какую мы и будем анализировать
'''

func = input('> Введите функцию f(x) = ')
a = float(input('   Введите начало отрезка: '))
b = float(input('   Введите конец отрезка: '))

print(dichotomy(a, b))

'''
Отображение графика на оси:

    * красным - основной график;
    * синим - полученный максимум на отрезке путем дихтомии;
    
Расстояние между действительным максимумом красного
и пересечением синих пунктиров - есть погрешность
'''

x = np.linspace(a, b, 1000)
y = f(x)

plt.axhline(y=f(c), color='blue', linestyle='--')
plt.axvline(x=c, color='blue', linestyle='--')
plt.plot(x, y, label='f(x)', color = 'red', linestyle = 'solid')
plt.title('График f(x)')
plt.xlabel('x')
plt.ylabel('y')
plt.grid(True)
plt.show()

Мною было добавлено множество комментариев, чтобы разъяснить ход выполнения программой своих действий, так намного удобнее воспринимать код и в будущем возвращаться к работе с ним




Леха Блинк
